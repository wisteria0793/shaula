# テスト計画書

## 1. テストの目的
本プロジェクトにおけるテスト活動は、以下の2点を目的とする。
1.  プロダクトの主要機能が、要求された仕様通りに動作することを保証する。
2.  テストプロセスの実践を通じて、品質保証に関する考え方、自動化技術、ツール選定の知識を深め、実践力を養う。

## 2. テスト範囲 (Scope)

### 2.1. 範囲内 (In Scope)
- 全てのバックエンドAPIにおけるCRUD（作成、読み取り、更新、削除）機能
- モデルやビジネスロジックに関するユニットテスト
- 主要な機能要件に関するE2Eテストの基本シナリオ

### 2.2. 範囲外 (Out of Scope)
- パフォーマンステスト、負荷テスト
- セキュリティ脆弱性診断
- 特定ブラウザ（例: Internet Explorer）での互換性テスト
- ユーザビリティテスト

## 3. テストの種類とツール

### 3.1. ユニットテスト (Unit Tests)
- **目的:** モデルのメソッドや個別の関数など、ごく小さな単位が正しく動作するかを検証する。
- **ツール:** Django標準の `TestCase` を使用する。

### 3.2. インテグレーションテスト (Integration Tests)
- **目的:** APIエンドポイントとして、複数のコンポーネント（ビュー、シリアライザー、モデル等）が連携して正しく機能するかを検証する。
- **ツール:** Django REST Framework の `APITestCase`, `factory-boy`, `parameterized` を使用する。

### 3.3. E2Eテスト (End-to-End Tests)
- **目的:** ユーザーの一連の操作をブラウザ側からシミュレートし、フロントエンドからバックエンドまで一気通貫で機能が正しく動作するかを検証する。
- **ツール:** Cypress または Playwright の導入を計画する。

## 4. テスト環境
- Docker Composeを用いて構築されたローカル開発環境でテストを実施する。

## 5. テストケースの管理
- テストケースは `docs/test_cases/` ディレクトリ配下に、機能ごとにMarkdown形式で作成・管理する。
- CSVを用いたデータ駆動テストのデータは `backend/[app]/test_data/` に配置する。
- 各テストケースは、以下の項目を含むこと。

| テストID | テスト項目 | 事前条件 | 手順 | 期待する結果 |
| :--- | :--- | :--- | :--- | :--- |
| FAC-001 | 正常なデータで施設が登録できる | ログイン済み | 1. 施設登録APIにPOST... | ステータスコード201が返る |

## 6. 不具合管理 (Defect Management)
- 発見された不具合は、すべて本リポジトリのGitHub Issues機能を用いて追跡・管理する。
- Issueを作成する際は、以下のテンプレートに従うこと。

  - **タイトル:** 不具合の内容を簡潔に。（例：【施設登録】名前が256文字以上だとサーバーエラーになる）
  - **再現手順:** どうすればその不具合が起きるか、具体的な手順を1から記述する。
  - **期待される振る舞い:** 本来どうあるべきだったか。
  - **実際の振る舞い:** 実際に何が起きたか。（スクリーンショットやエラーログを添付すると尚良い）
  - **環境:** 不具合が起きた環境。（例：ブラウザ: Chrome 108, OS: macOS）

## 7. テストの完了条件
- 本計画書に定められた範囲のテストケースがすべて実施されていること。
- 重大な（Critical）または主要な（Major）不具合がすべて修正されていること。

---

## 付録: 品質を意識した開発フローの指針

### 基本方針
各機能の開発サイクルに、テストを密接に連携させる「シフトレフト」のアプローチを取る。

### 1. 機能の要件定義・設計フェーズ
開発者がコードを書き始める前からQAの視点を入れ、仕様の曖昧さをなくす。
- **質問による仕様の明確化:**「正常系・異常系は？」「入力値の制限は？」
- **テスト計画の作成:** 仕様に基づき、どのようなテストケースが必要かを事前に洗い出す。

### 2. バックエンド開発フェーズ
APIが完成した時点で、UIがなくてもすぐにテストを開始する。
- **APIテストの実施:** `APITestCase`を用いて、APIが仕様通りに動作するかを単体でテストする。
- **ユニットテストの確認:** 開発者が書くユニットテストが、重要なロジックをカバーしているかを確認する。

### 3. フロントエンド開発フェーズ
UIがAPIと結合されたら、ユーザー視点でテストする。
- **E2Eテストの実施:** ユーザーの一連の操作をシミュレートし、機能全体が正しく動作するかを確認する。

### 4. CI/CDパイプラインへの統合
品質保証のプロセスを自動化する。
- **テストの自動実行:** コードがリポジトリにプッシュされた際、ユニットテストやAPIテストが自動実行される環境を構築する (GitHub Actionsなど)。
- **自動リグレッションテスト:** 新機能の追加によって既存機能が壊れていないかを、自動テストで常にチェックする。
